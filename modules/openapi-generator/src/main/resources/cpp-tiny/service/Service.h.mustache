#ifndef TINY_CPP_CLIENT_ABSTRACTSERVICE_H_
#define TINY_CPP_CLIENT_ABSTRACTSERVICE_H_
{{#isESP8266}}
#include <WiFiClient.h>
#include <ESP8266HTTPClient.h>
{{/isESP8266}}

{{#isESP32}}
#include <WiFiClientSecure.h>
#include <ArduinoHttpClient.h>
{{/isESP32}}
#include <list>

namespace Tiny {

/**
*  Class
* Generated with openapi::tiny-cpp-client
*/
class ApiConfiguration {
    private:
        String host = "";
        uint16_t port;
        String apiKey;
        String sslCertificate;

    public:
        // Constructor
        ApiConfiguration();

        // Getters
        String getHost() const;
        uint16_t getPort() const;
        String getApiKey() const;
        String getSslCertificate() const;

        // Setters
        void setHost(const String host);
        void setPort(const uint16_t port);
        void setApiKey(String apiKey);
        void setSslCertificate(String sslCertificate);
};

/**
*  Class
* Generated with openapi::tiny-cpp-client
*/
class Service {
    public:
        std::unique_ptr<HttpClient> client;
        {{#isESP8266}}
        WiFiClient client;
        {{/isESP8266}}
        {{#isESP32}}
        WiFiClientSecure wifiClient;
        {{/isESP32}}
        std::string basepath = "";
        String host = "";
        uint16_t port;
        String apiKey;
        String sslCertificate = "";
        std::string url = "";
        std::string payload = "";
        std::list<std::tuple<std::string, std::string>> queryParams;
        std::list<std::tuple<std::string, std::string>> formParams;

        Service();

        void setApiConfiguration(const ApiConfiguration conf);
        int sendRequest(std::string url, const char * type, uint8_t * payload, size_t size);
        String getResponseBody();

        void addQueryParam(std::string key, std::string value);
        void addFormParam(std::string key, std::string value);
        void addHeader(std::string key, std::string value);

    private:
        void begin(std::string url);
        void prepareRequest();
        std::string encodeKeyValueTuple(std::list<std::tuple<std::string, std::string>> params);

}; // end class
}// namespace Tinyclient

#endif /* TINY_CPP_CLIENT_ABSTRACTSERVICE_H_ */
